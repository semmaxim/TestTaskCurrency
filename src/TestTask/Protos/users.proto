syntax = "proto3";

package users;

// Описание сервиса управления пользователями
service UsersService {
  // Проверяет наличие пользователя с указанным логином
  rpc IsUserExists(IsUserExistsRequest) returns (IsUserExistsResponse);

  // Регистрация нового пользователя
  rpc AddUser(AddUserRequest) returns (AddUserResponse);

  // Получение данных для аутентифицкации пользователя по логину
  rpc GetUserCredentials(GetUserCredentialsRequest) returns (GetUserCredentialsResponse);
}

// Запрос проверки существования пользователя
message IsUserExistsRequest {
  string login = 1;
}

// Ответ проверки существования пользователя
message IsUserExistsResponse {
  bool exists = 1;
}

// Запрос добавления нового пользователя
message AddUserRequest {
  string login = 1;
  string passwordHash = 2;
  string passwordSalt = 3;
  repeated string codes = 4;
}

// Ответ успешного добавления пользователя
message AddUserResponse {
  bool success = 1;
}

// Запрос на получение данных для аутентифицкации пользователя по логину
message GetUserCredentialsRequest {
	string login = 1;
}

// Ответ на получение данных для аутентифицкации пользователя по логину
message GetUserCredentialsResponse {
	string passwordHash = 1;
	string passwordSalt = 2;
}
